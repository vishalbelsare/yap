

PROJECT ( YAP_LBFGS C )

SET ( YAP_LBFGS_VERSION 0.1)

if (NOT YAP_FOUND)
  FIND_PACKAGE(YAP REQUIRED)
ENDIF (NOT YAP_FOUND)
IF (NOT YAP_FOUND)
  MESSAGE (SEND_ERROR "YAP was not found!")
ENDIF (NOT YAP_FOUND)

  set (LBFGS_SRC liblbfgs-1.10)

  INCLUDE_DIRECTORIES(
    ${CMAKE_CURRENT_SOURCE_DIR}/${LBFGS_SRC}/include
    ${CMAKE_CURRENT_BINARY_DIR}
    ${CMAKE_SOURCE_DIR}/include

    )

  SET ( LBFGS_HEADERS ${CMAKE_CURRENT_SOURCE_DIR}/${LBFGS_SRC}/lib/arithmetic_ansi.h  ${CMAKE_CURRENT_SOURCE_DIR}/${LBFGS_SRC}/lib/arithmetic_sse_double.h  ${CMAKE_CURRENT_SOURCE_DIR}/${LBFGS_SRC}/lib/arithmetic_sse_float.h )
    
  SET ( LBFGS_SOURCES
  
  ${CMAKE_CURRENT_SOURCE_DIR}/${LBFGS_SRC}/lib/lbfgs.c ${CMAKE_CURRENT_SOURCE_DIR}/yap_lbfgs.c)

  add_library(YAPLBFGS
  ${LBFGS_SOURCES})

    TARGET_LINK_LIBRARIES(YAPLBFGS
      libYap
      )
   

  install(TARGETS  YAPLBFGS
          LIBRARY DESTINATION ${YAP_INSTALL_DLLDIR}
          RUNTIME DESTINATION ${YAP_INSTALL_DLLDIR}
    ARCHIVE DESTINATION ${YAP_INSTALL_DLLDIR} 

    )

  INSTALL(FILES lbfgs.pl DESTINATION ${YAP_INSTALL_DATADIR})
  
